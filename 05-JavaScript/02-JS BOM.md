## 注意

一、window一个特殊的属性:window.name,建议不用name当变量。

二、alert()、prompt()、confirm()实际不用，各浏览器样式不一样、不可控。改进：用div+CSS制作	对话框+后面的遮挡层。

三、javaScript分三个部分：

1.ECMAScript标准——基本语法

2.DOM——Document Object Model 文档对象模型，操作页面元素的

3.BOM——Browser Object Model 浏览器对象模型，操作浏览器的

## 顶级对象

浏览器的顶级对象：window

页面的顶级对象：document

> 页面中所有内容（包括window）都是属于浏览器的——页面中的内容也都是window的，所以window是可以省略的
>

jQuery中顶级对象：$

## 页面加载事件

- onload——页面加载完后事件

- onunload——页面关闭后事件（谷歌不兼容）
- onbeforeunload——页面关闭前事件（谷歌不兼容）

## location对象——地址栏URL上的操作

```javascript
console.log(window.location);	//返回的是浏览器地址
```

**属性（无括号）：**返回URL的各组成部分

```javascript
//地址栏上#及后面的内容
console.log(window.location.hash);
//主机名及端口号（“窗口”）
console.log(window.location.host);
//主机名
console.log(window.location.hostname);
//文件的路径---相对路径
console.log(window.location.pathname);
//端口号
console.log(window.location.port);
//协议
console.log(window.location.protocol);
//搜索的内容（s?后面的）
console.log(window.location.search);

//属性，跳转页面的，必须记住
location.href="http://www.jd.com";
```

**方法（有括号）：** 

```javascript
//这2个有历史记录
location.href="http://www.jd.com";//跳转页面属性----------------->必须记住
location.assign("http://www.jd.com");//跳转页面方法

location.reload();//刷新
location.replace("http://www.jd.com");//替换地址栏上的地址，没有历史记录
```

## history对象——历史纪录的后退和前进

了解有这几种即可，用不到。

- back()	后退
- forward()    前进
- go()

## navigator对象——获取系统、浏览器的信息

**属性：**

- userAgent

通过userAgent可以判断用户浏览器的类型

- platform

通过platform可以判断浏览器所在的系统平台类型.

## 定时器：setTimeout()

BOM中有2个定时器。

setTimeout（函数，时间）；	//一次性的定时器

返回值：该定时器的id

clearTimeout（id）；	//虽一次性，但也要清理所占空间。

## 定时器：setInterval()

定时器：有方法setInterval()、clearInterval(); //隔一段时间就执行一次函数的定时器

```
一、设置定时器
//参数1:函数  参数2:时间---毫秒---1000毫秒--1秒
//执行过程:页面加载完毕后,每隔1秒就执行一次，一直执行。
//该定时器会返回自己的id值——如timeId
var timeId = setInterval(function () {
    alert("hello");//断言
}, 1000);
二、清理定时器
document.getElementById("btn").onclick = function () {
    //点击按钮,停止定时器
    //参数:要清理的定时的id的值
    window.clearInterval(timeId);
  };
```

## 相关实例

### 封装动画函数（匀速、缓动（变速））

#### 匀速的动画函数

```javascript
//设置任意的一个元素,移动到指定的目标位置
function animate(element, target) {
  //因为每点击一次按钮都会产生定时器，所以要先清除定时器
  clearInterval(element.timeId);
  //因为元素要移动，所以要设定时器。
  //把定时器的id值存储到一个对象的一个属性中，方便清理
  element.timeId = setInterval(function () {
    //获取元素的当前的位置,数字类型
    var current = element.offsetLeft;
    //每次移动的距离
    var step = 10;
    //从左往右：走正数。从右往左：走负数
    step = current < target ? step : -step;
    //当前移动到位置
    current += step;
    //判断目标位置与当前位置的距离
    if (Math.abs(current - target) > Math.abs(step)) {
      element.style.left = current + "px";
    } else {
      //清理定时器
      clearInterval(element.timeId);
      //直接到达目标
      element.style.left = target + "px";
    }
  }, 20);
}
```

#### 变速（缓动）的动画函数

```javascript
当前位置：current
目标位置：target
缓动的效果：步数=（目标-当前）/10。 由快到慢
注意：如果步数>0，向上取整，返回向下。又变速可到1，所以不需要判断当前、目标、步数三者关系
```

##### 	筋斗云导航栏案例：

> 关键：不是点击的时候效果定在这，点击只是记录了此次点击的位置，而是离开时定在这的：回到上一次点的位置。
>
> 过程：获取云彩；获取所有的li标签；循环遍历分别注册鼠标进入（ 封装动画函数移动云彩的左边距，移动到鼠标此次进入的li的位置animate(cloud,this.offsetLeft)）、鼠标点击（点击时记录此次点击的位置，没点就回去：先设外面var LastPosition=0回去，再里面LastPosition=this.offsetLeft）、鼠标离开事件（离开定在上一次点击位置：animate(cloud,LastPostion)）。因为循环，所以用命名函数。
>
> 

升级4-5次变速函数（理解即可，能写出最终版本）

#### 封装缓动动画函数增加任意一个属性

> 1.添加获取计算后的任意一个样式属性函数值
>
> 2.将width改成变量attr，**定时器添加个变量attr到参数2。**
>
> 3.获取元素当前位置改为parseInt（getStyle（element，attr））

#### 封装缓动动画函数增加任意多个属性

> 最初做法：给动画函数添加多个参数，来获取**一对数据**（任意多个属性、对应的属性值为：目标位置）。一对的数据用json对象组成。
>
> 优化：function animate(element,**json**)
>
> 按钮事件里定义json:animate（my$("dv"),{...}）;
>
> 动画函数里原来只能操作一个属性一个目标，要操作多个属性多个目标：将定时器内代码都放到循环遍历里，让var target=json[attr]（.变量；[“属性”]）
>
> bug：原来只要有一个属性到达目标就清除定时器，现在要让每个属性全到达目标才清理——改成
>
> ```
>   if(current!=target){
>     flag=false;
>   }
> }
> if(flag){
>   //清理定时器
>   clearInterval(element.timeId);
> }
> ```

#### 封装缓动动画函数增加任意多个属性、回调函数：实现多个动画

回调函数：当一个函数作为参数使用，就是回调函数。

在哪加？function animate（，，这加）。

在哪用？所有属性全部到达目标位置时用——在if（flag）中清除定时器后写：判断有没传入回调函数？传入才调用：

```javascript
if(fn){
  fn();
}
```

#### 在上面再增加透明度、层级（最终版本）

思路——

zIndex:直接赋值

opacity：数字类型——小数——放大100倍。再在获取计算后的值那除100且不需px。

把上面2个都当成json的属性

在哪改？json代码块里改：放里面的前面，判断json属性是否=他两，if（放除判断是否到达目标的代码，但透明度不需取整且当前、目标都*100。再在获取计算后的值那除100且不需px）-else if（层级改变就是直接改变它的属性值）-else（放除判断是否到达目标的代码）

#### 手风琴案例

1. 设个放手风琴的div
2. 加载图片：先获取所有的li标签。循环中设置背景图片
3. 事件：在上述循环中加入鼠标进入、鼠标离开事件（因为循环，所以命名函数事件）
4. 鼠标进入函数：排他、设动画效果：循环中设li都为宽100，循环外设当前li宽为800
5. 鼠标离开函数：循环设置所有都恢复：宽为原来宽
6. bug：进入时最后一个宽较窄，不管

#### 开、关机动画案例

关键：给×注册点击事件——动画函数设置最下面的div高渐渐变0，回调函数设置整个box的宽渐渐变0

#### 旋转木马案例

关键：数组的四个添加删除方法、图片散开：动画函数中设（层级、透明度、宽上左）、assign()重新分配函数

过程：

1.图片散开：找到所有li，声明为list，然后把代码放入function assign()（加载后图片（li）散开循环给每个设动画函数），再调用

2.左右焦点按钮：a的href可以写地址、锚点、javascript:;(用来点击做什么事的,中间的void(0)可省)

鼠标进入，左右焦点的div渐渐显示：用动画函数设透明度为1

鼠标离开，渐渐隐藏：用动画函数设透明度为0

3.点击右边按钮事件：让图片依次换json属性组，用数组的四个添加删除方法——这里用config.push(config.shift());assign();

4.点左边按钮：config.unshift(config.pop());assign();

5.加锁：防止鼠标点多次动画没时间加载导致卷起来——

在加载事件中先设置var flag=true;//假设所有的动画执行完毕了——锁。再把左、右边按钮事件改为**if(flag){flag=false;**con...;assign();**};**。重新分配函数中再把里面的动画函数添加个函数作参数3，其中代码flag=true;

### 轮播图

3个功能：自动切换、鼠标在小圆点切换、鼠标在左右箭头切换

#### 简单的轮播图

鼠标图片在小圆点切换

> 关键点：排他功能、移动ul(每个图片的宽*鼠标放在这个按钮的索引值)、封装动画函数、overflow:hidden;
>
> 步骤：获取需要的元素值（相框的父级、相框、相框宽度、ul、所有span）、循环排他、循环时候把索引值保存在每个span的自定义属性中、获取当前鼠标进入的span的索引、用封装动画函数来切换图片（-宽*索引值）

#### 左右焦点轮播图

> 关键：获取span—>获取一个左右焦点所在的div。给2个div都注册事件。显示和隐藏左右焦点的div——为box注册事件。直接index++/--，不需存放index。用封装动画函数来切换图片（-宽*索引值） 

#### 无缝连接的轮播图（用到定时器）

最后一张再到显示第一张

> 功能：当页面加载时图片移动（定时器）、当鼠标进去时停止出来又继续移动
>
> 关键：原相框+一张假图（第一张图），当到原相框（-多少px）时跳回第一张图0px且让current变回0。定时器。进入box停止，即清除定时器。离开box时再重新开个定时器

#### 完整的轮播图

3个功能：自动切换、鼠标在小圆点切换、鼠标在左右箭头切换

> ```javascript
> 完整思路：
> 1. 根据ul中li个数(图片的个数)动态的创建li,并且加入到ol中,作为小按钮来使用
> 为每个ol中的li添加鼠标进入的事件,(添加事件之前,先把索引保存在每个li的自定义属性中),鼠标进入li的时候做排他功能(背景颜色),移动图片(图片整体移动,移动的ul,每次移动的是一个图片的宽度,图片的宽度就是向宽的宽度),调用的是动画函数,移动ul,移动的是索引值*图片的宽度,并且把索引值存储在一个全局变量中,pic
> 2. 创建li之后,1---设置ol中第一个li有默认的背景颜色,2---把ul中的第一个li克隆一下(无缝连接的效果)追加到ul中所有的li的最后面(无缝效果:页面中的第一个图片和最后一个图片是同一个图片)
> 3.左右焦点的div显示和隐藏
> 4.为左右按钮注册点击事件
> 每一次点击右边的按钮,先判断pic的值是不是ul中li的length-1(pic的值最大是5),此时设置pic的值为0,同时设置ul距离左边的left值为0(初始值),此时pic立刻加1,移动ul,用户看到的就是第二个图片
> 设置小按钮的背景颜色
> 左边按钮,需要判断pic值是不是0,如果是0此时pic=5,ul的left为5*图片的宽,立刻pic-1,然后ul移动一张图片,此时用户看到了第五个图片
> 5.自动播放在页面加载的时候,启动一个定时器,里面调用的就是右边按钮的点击事件的处理函数
> ```
>
> 1.先获取元素：（父级div、相框、相框宽度、ul、ul中的所有li、ol、焦点的div）
>
> 2.按钮移动图片：
>
> ​	创建小按钮——根据ul中的li个数（创建li标签、加入到ol中、添加li内容；在每个ol中的li标签上添加一个自定义属性，存储索引值注册鼠标进入事件（排他功能：先干掉所有li的背景颜色i=空，再设置当前鼠标进来的li的背景颜色this=，   获取鼠标进入的li的当前索引值，   移动ul））
>
> ​	设置ol中第一个li有背景颜色
>
> 3.右侧点击按钮移动图片：
>
> ​	无缝效果：克隆一个ul中第一个li，加到ul中的最后（true克隆标签包括内容）
>
> ​	鼠标进入到box的div显示左右焦点的div
>
> ​	鼠标离开隐藏div
>
> ​	右按钮事件：①利用同步   来对应上个按钮的下一张（如var p=0；function f1(){p++;}f1();console.log(p);输出p=1）②封装动画函数来移动ul   ③达到无缝效果：判断，**当用户看到假图pic=length-1时，pic变成0跳到真图**，所以要放在pic++前面
>
> ④焦点要与上个按钮同步：判断，（如果pic==5说明显示第6个图——假图，第一个小按钮有颜色，所以）当用户看到假图pic=length-1时，设置上个按钮的背景颜色：length-1变为空，0变色。否则排他功能：先干掉所有li的背景颜色i=空，再设置当前鼠标进来的li的背景颜色pic=。
>
> 4.左按钮事件
>
> ​	①图片移动：与右的差别
>
> 如果pic==0，**pic要变成5**，要显示最后一张：left=-pic*imgWidth+”px“；
>
> ​	**pic--**
>
> ​	动画函数让ul负移动：-pic*imgWidth
>
> ​	②排他功能：i、pic
>
> 5.自动播放功能：
>
> 定时器：隔一段事件调用右按钮事件——先将右按钮事件的函数写成命名函数。再将定时器放在克隆后面，setInterval(命名函数，1000)。再将封装动画函数改成10毫秒，保证1秒内移动完图片。鼠标进来时清理定时器，离开时设定时器。

### 小实例：

先总结思路，再第二天不看编程，最后再修改。

#### 强制阅读协议按钮

> 思路：给该按钮设定时器并不让点击，当time为0时，按钮值改为同意且可点击并取消定时器。

#### div渐变

> 思路：给按钮设定时器：透明度逐渐从1到0（因为小数的结果不一定，所以先设个变量opacity为10让其每隔1秒减一，之后再/10，再赋给div的style.opacity。
>
> 当opacity<=0时，清除定时器，防止一直减下去。

div变宽

给按钮事件设置定时器

定时器中：设变量，每隔多少+=。

​					给div的style.width赋值

​					设if语句设清除定时器条件。

#### 移动元素

```
400时：
按钮事件里设定时器
获取div的当前的位置
div每次移动多少像素---步数
每次移动后的距离
if判断当前移动后的位置是否到达目标位置
else清理定时器
800时：同理
```

#### 迂回移动元素、封装动画函数

> 思路：2按钮事件功能相同，所以可封装
>
> 1. 获取要移动div的当前位置
>
> 2. div每次移动多少像素——步数（**迂回，所以给步数赋的值要相反**）
>
> 3. 每次移动后的距离
>
> 4. if——判断当前移动后的位置是否到达目标位置（注意：current与target距离若小于步数情况）
>
> 5. else——清除（一个）定时器
>
> 6. ```
>   注意——每点击按钮都会产生一个定时器
>   //要先在函数里清理定时器
>   clearInterval(element.timeId);
>   ```
> ```
> 
> ```
>
> ```
> 
> ```
>
> ```
> 
> ```
>
> ```
> 
> ```
>
> ```
> 
> ```
>
> ```
> 
> ```
>
> ```
> 
> ```
>
> ```
> 
> ```

#### 一起摇

> 思路
>
> 1.将要摇的部分放入div（父元素）中，让div（父元素）动
>
> 2.设两个按钮：摇起来、停止
>
> 3.该部分原本以文档流方式在左上，接着以脱离文档流方式移动位置
>
> 脱离文档流：position:absolute;	//div的CSS样式
>
> 要想动起来：改left（横坐标x）、top（纵坐标y）值
>
> 要想动多次：隔几秒动一次——设定时器	//将js断言代码放入，合理调速度
>
> 横纵坐标不确定：给left、top都设随机数	//代码优化：设变量x、y，再赋值给left、top
>
> 4.停止：清除定时器函数，注意全局变量与局部变量
>
> 5.以编程规范编写代码。

#### 一闪一闪亮晶晶

> 1. 点击“亮起来”按钮、给div创建元素：星星
> 2. 位置：给left、top随机值
> 3. 脱离文档流：position:absolute;
> 4. 设定时器

#### 美女图片时钟

> 1. 获取当前时间：时间对象
> 2. 获取小时。注意<10时，前面加个“0“，用三元操作符
> 3. 获取秒。
> 4. 按时间输出图片。输出时把要动态变化的部分用**字符串拼接变量**的方式拼接。
> 5. 定时器：页面加载完后隔1秒才执行。要马上执行：把前面函数先声明，定时器代码执行前先执行一遍之前函数。



